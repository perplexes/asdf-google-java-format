#!/usr/bin/env sh
set -eu

filter="${1:-}"

all="$( "$(dirname "$0")/list-all" )"

# Convert to newline list for easy filtering
nl="$(printf '%s' "$all" | tr ' ' '\n' | awk 'NF')"

if [ -n "$filter" ]; then
  nl="$(printf '%s\n' "$nl" | awk -v f="$filter" 'index($0,f)==1')"
fi

# Take the last line (newest) portably
latest="$(printf '%s\n' "$nl" | awk 'NF{last=$0} END{if(last)print last}')"

[ -n "$latest" ] && printf '%s\n' "$latest"
